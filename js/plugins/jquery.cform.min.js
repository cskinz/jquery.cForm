/*!
 * jQuery cForms v1.2.1
 * http://cforms.jacksbox.de
 *
 * Author: Mario JÃ¤ckle
 * eMail: support@jacksbox.de
 *
 * Copyright 2015, jacksbox.design
 * Free to use under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 */
!function(e){e.cForm=function(t){var a=this;a.$element=e(t),a.element=t,a.$element.data("cForm",a),a.init=function(){a.options=e.extend({},e.cForm.defaultOptions,a.options),a.options.templates=e.extend({},e.cForm.defaultOptions.templates,a.options.templates);var t=["input","textarea","select","button"];if(a.radioGroupArray=[],a.$element.is(t.join())){var n=a.tagName(a.$element);"input"===n&&a.identifyInputType(a.$element),"select"===n&&a.handleSelect(a.$element),"button"===n&&a.handleButton(a.$element),"textarea"===n&&a.handleTextarea(a.$element)}else a.$element.find("input").each(function(){a.identifyInputType(e(this))}),a.$element.find("select").each(function(){a.handleSelect(e(this))}),a.$element.find("button").each(function(){a.handleButton(e(this))}),a.$element.find("textarea").each(function(){a.handleTextarea(e(this))})},a.identifyInputType=function(e){var t=e.attr("type");if("undefined"==typeof t&&t===!1)return console.log("Error: Missing type-Attribute on input!"),!1;switch(t){case"password":case"text":a.handleInputText(e,t);break;case"file":a.handleInputFile(e);break;case"checkbox":a.handleInputCheckbox(e);break;case"radio":a.handleInputRadio(e);break;case"submit":a.handleInputSubmit(e);break;default:console.log("Error: No matching was found - You will be forever alone!")}},a.handleButton=function(e){var t=a.options.templates.button;e.wrap(t)},a.handleInputSubmit=function(e){var t=a.options.templates.submit;e.wrap(t)},a.handleInputText=function(e,t){var n=a.options.templates[t];e.wrap(n)},a.handleTextarea=function(e){var t=a.options.templates.textarea;e.wrap(t)},a.inputData=function(t){return this.name=t.attr("name"),this.value=t.attr("value"),this.checked=t.attr("checked"),this.template=a.options.templates[t.attr("type")],this.$html=e(),"undefined"==typeof this.name&&this.name===!1&&(this.name=""),"undefined"==typeof this.value&&this.value===!1&&(this.value=""),"undefined"==typeof this.checked&&this.checked===!1&&(this.checked=""),this},a.handleInputFile=function(t){var n=a.inputData(t);n.$html=e(n.template.replace("{{name}}",n.name)),n.$html.bind("click",{$node:t},function(e){var t=e.data.$node;t.trigger("click")}),t.bind("change",{$html:n.$html},function(t){var a=e(this).val().split("\\").pop(),n=t.data.$html;n.addClass("filled").find(".cform-filename").text(a)}),a.addToDom(t,n.$html)},a.handleInputCheckbox=function(t){var n=a.inputData(t);n.$html=e(n.template.replace("{{name}}",n.name).replace("{{value}}",n.value)),(n.checked||"checked"===n.checked)&&n.$html.addClass("checked").data("checked",!0),n.$html.bind("click",{$origin:t},function(t){var a=e(this),n=t.data.$origin,i=a.data("checked");i?(n.prop("checked",!1),a.removeClass("checked").data("checked",!1)):(n.prop("checked",!0),a.addClass("checked").data("checked",!0))}),t.bind("change",{$mirror:n.$html},function(t){var a=e(this),n=t.data.$mirror;a.prop("checked")?n.addClass("checked").data("checked",!0):n.removeClass("checked").data("checked",!1)}),a.addToDom(t,n.$html)},a.handleInputRadio=function(t){var n=a.inputData(t);if(a.radioGroupArray.indexOf(n.name)>-1)return!1;a.radioGroupArray.push(n.name);var i=e();$nodes=a.$element.find('input[type="radio"][name="'+n.name+'"]'),$nodes.each(function(){var t=e(this),a=t.val(),l=t.attr("checked"),d=e();d=e(n.template.replace("{{name}}",n.name).replace("{{value}}",a)),l&&d.addClass("checked").data("checked","true"),i=i.add(d),t.addClass("cform-hidden").after(d)}),i.bind("click",{$mirrors:i,$origins:$nodes},function(t){var a=e(this),n=t.data.$mirrors,i=t.data.$origins,l=a.data("value");return a.data("checked")?!0:(n.removeClass("checked").data("checked",!1),a.addClass("checked").data("checked",!0),void i.prop("checked",!0).filter('[value="'+l+'"]').prop("checked",!0))}),$nodes.bind("change",{$mirrors:i,$origins:$nodes},function(t){var a=e(this),n=t.data.$mirrors,i=(t.data.$origins,a.val());return a.data("checked")?!0:void n.removeClass("checked").data("checked",!1).filter('[data-value="'+i+'"]').data("checked",!0).addClass("checked")}),a.addToDom(t,n.$html)},a.handleSelect=function(t){var n=a.inputData(t);n.multiple=t.attr("multiple"),n.$subnodes=t.find("option"),n.$selected=n.$subnodes.filter(":selected"),n.$options=e(),"undefined"==typeof n.multiple||n.multiple===!1?(n.multiple=!1,n.template=a.options.templates.select,n.$html=e(n.template.replace("{{name}}",n.name).replace("{{text}}",n.$selected.html()))):(n.multiple=!0,n.template=a.options.templates.multiselect,n.$html=e(n.template.replace("{{name}}",n.name))),n.$subnodes.each(function(){var t=e(this),i=t.prop("selected")?"selected":"",l=a.options.templates.option;l=l.replace("{{value}}",t.val()).replace("{{text}}",t.html()),n.$options=n.$options.add(e(l).addClass(i))}),n.$html.find(".cform-control").bind("click",{$mirror:n.$html},function(t){$mirror=t.data.$mirror,$mirror.addClass("active"),e(document).bind("click.cForm",{$mirror:$mirror},function(t){$mirror=t.data.$mirror,e(t.target).closest(".cform-select").length||($mirror.removeClass("active"),e(document).unbind("click.cForm"))})}),n.$options.bind("click",{$origin:t,$mirror:n.$html,$options:n.$options,multiple:n.multiple},function(t){var a=e(this),n=t.data.$origin,i=t.data.$mirror,l=t.data.$options,d=t.data.multiple,o=a.data("value"),c=a.html();if(d){var r=[];a.hasClass("selected")?(r=n.val(),r.splice(r.indexOf(o),1),n.val(r),i.data("value",r),a.removeClass("selected")):(r=n.val()?n.val():[],r.push(o),n.val(r),i.data("value",r),a.addClass("selected"))}else l.not(a).removeClass("selected"),a.addClass("selected"),n.val(o),i.data("value",o).removeClass("active").find(".cform-control .text").html(c)}),t.bind("change",{$origin:t,$mirror:n.$html,$options:n.$options,multiple:n.multiple},function(t){var a=e(this),n=a.val(),i=a.find('option[value="'+n+'"]').html(),l=t.data.$origin,d=t.data.$mirror,o=t.data.$options,c=t.data.multiple;if(c){var r=l.val()?l.val():[],s=0;for(console.log(r),d.data("value",r),o.removeClass("selected"),s=0;s<r.length;s++)o.filter('[data-value="'+r[s]+'"]').addClass("selected")}else d.data("value",n).find(".cform-control").html(i),o.removeClass("selected").filter('[data-value="'+n+'"]').addClass("selected")}),n.$html.find("ul").append(n.$options),a.addToDom(t,n.$html)},a.addToDom=function(e,t){e.addClass("cform-hidden").after(t)},a.tagName=function(e){return e.prop("tagName").toLowerCase()},a.init()},e.cForm.defaultOptions={templates:{text:'<div class="cform-text"></div>',textarea:'<div class="cform-text"></div>',password:'<div class="cform-text cform-password"></div>',file:'<div class="cform-file" data-name="{{name}}">    							<div class="cform-control">choose file</div>    							<div class="cform-filename"> click here</div>    						</div>',checkbox:'<div class="cform-checkbox" data-name="{{name}}" data-value="{{value}}">    							<div class="cform-marker"></div>    						</div>',radio:'<div class="cform-radio" data-name="{{name}}" data-value="{{value}}">    							<div class="cform-marker"></div>    						</div>',select:'<div class="cform-select" data-name="{{name}}">    							<div class="cform-control"><span class="text">{{text}}</span><span class="chevron bottom"></span></div>    							<ul></ul>    						</div>',multiselect:'<div class="cform-multiselect" data-name="{{name}}">    							<ul></ul>    						</div>',option:'<li data-value="{{value}}">{{text}}</li>',button:'<div class="cform-button"></div>',submit:'<div class="cform-submit"></div>'}},e.fn.cForm=function(t){return this.each(function(){new e.cForm(this,t)})}}(jQuery);